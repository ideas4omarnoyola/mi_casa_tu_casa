<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página 26</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="../css/estilos.css">

    <!-- Librerias -->
    <script src="../js/librerias/jquery.min.js"></script>
    <script src="../js/librerias/gsap.min.js"></script>
    <script src="../js/librerias/jquery-ui.min.js"></script>
    <script src="../js/librerias/jquery.ui.touch-punch.min.js"></script>

    <!-- Script de animaciones -->
    <script src="../js/animaciones.js"></script>
    <!-- Scripts posicionar elementos -->
    <script src="../js/redimensionarElementos.js"></script>
    <script src="../js/posicionar.js"></script>

</head>
<body class="pagina">
    <img class="elementos" id="texto" src="../img/pagina26/texto.png" data-posX="0" data-posY="0" alt="">
    <img class="elementos" id="fondo" src="../img/pagina26/fondo.png" data-posX="0" data-posY="0" alt="">

    <div class="elementos drops" id="drop1" data-lugar="1" data-posX="280" data-posY="195"></div>
    <div class="elementos drops" id="drop2" data-lugar="2" data-posX="288" data-posY="493"></div>
    <div class="elementos drops" id="drop3" data-lugar="3" data-posX="817" data-posY="200"></div>
    <div class="elementos drops" id="drop4" data-lugar="4" data-posX="787" data-posY="501"></div>
    <div class="elementos drops" id="drop5" data-lugar="5" data-posX="837" data-posY="205"></div>

    <img class="elementos drags" id="drag1" data-lugar="1" src="../img/pagina26/drag1.png" data-posX="597" data-posY="177" alt="">
    <img class="elementos drags" id="drag2" data-lugar="2" src="../img/pagina26/drag2.png" data-posX="476" data-posY="189" alt="">
    <img class="elementos drags" id="drag3" data-lugar="3" src="../img/pagina26/drag3.png" data-posX="506" data-posY="245" alt="">
    <img class="elementos drags" id="drag4" data-lugar="4" src="../img/pagina26/drag4.png" data-posX="588" data-posY="395" alt="">
    <img class="elementos drags" id="drag5" data-lugar="5" src="../img/pagina26/drag5.png" data-posX="690" data-posY="245" alt="">

    <img class="elementos" id="fondo2" src="../img/pagina26/fondo2.png" data-posX="0" data-posY="0" alt="">

    <div class="elementos drops" id="drop6" data-lugar="6" data-posX="182" data-posY="218"></div>
    <div class="elementos drops" id="drop7" data-lugar="7" data-posX="281" data-posY="259"></div>
    <div class="elementos drops" id="drop8" data-lugar="8" data-posX="879" data-posY="393"></div>
    <div class="elementos drops" id="drop9" data-lugar="9" data-posX="892" data-posY="252"></div>
    <div class="elementos drops" id="drop10" data-lugar="10" data-posX="791" data-posY="216"></div>
    <div class="elementos drops" id="drop11" data-lugar="11" data-posX="925" data-posY="256"></div>
    <div class="elementos drops" id="drop12" data-lugar="12" data-posX="821" data-posY="219"></div>

    <img class="elementos drags" id="drag6" data-lugar="6" src="../img/pagina26/drag6.png" data-posX="414" data-posY="215" alt="">
    <img class="elementos drags" id="drag7" data-lugar="7" src="../img/pagina26/drag7.png" data-posX="669" data-posY="264" alt="">
    <img class="elementos drags" id="drag8" data-lugar="8" src="../img/pagina26/drag8.png" data-posX="573" data-posY="334" alt="">
    <img class="elementos drags" id="drag9" data-lugar="9" src="../img/pagina26/drag9.png" data-posX="488" data-posY="343" alt="">
    <img class="elementos drags" id="drag10" data-lugar="10" src="../img/pagina26/drag10.png" data-posX="549" data-posY="128" alt="">
    <img class="elementos drags" id="drag11" data-lugar="11" src="../img/pagina26/drag11.png" data-posX="657" data-posY="182" alt="">
    <img class="elementos drags" id="drag12" data-lugar="12" src="../img/pagina26/drag12.png" data-posX="508" data-posY="203" alt="">

    <img class="elementos" id="retro" src="../img/pagina26/retro.png" data-posX="0" data-posY="0" alt="">

    <style>
        #drop1{
            width: 80px;
            height: 186px;
        }
        #drop2{
            width: 64px;
            height: 22px;
        }
        #drop3{
            width: 60px;
            height: 202px;
        }
        #drop4{
            width: 120px;
            height: 22px;
        }
        #drop5{
            width: 30px;
            height: 50px;
        }
        #drop6{
            width: 60px;
            height: 148px;
        }
        #drop7{
            width: 65px;
            height: 132px;
        }
        #drop8{
            width: 116px;
            height: 126px;
        }
        #drop9{
            width: 92px;
            height: 146px;
        }
        #drop10{
            width: 89px;
            height: 194px;
        }
        #drop11{
            width: 37px;
            height: 71px;
        }
        #drop12{
            width: 39px;
            height: 71px;
        }
    </style>


    <!-- Script de la página -->
    <script>

        // Variable----------------------------------------------------
        let aplicacion = parent;

        const texto = $('#texto');
        const fondo = $('#fondo');
        const fondo2 = $('#fondo2');
        const retro = $('#retro');

        const drags = $('.drags');
        const drops = $('.drops');

        const drag1 = $('#drag1');
        const drag2 = $('#drag2');
        const drag3 = $('#drag3');
        const drag4 = $('#drag4');
        const drag5 = $('#drag5');
        const drag6 = $('#drag6');
        const drag7 = $('#drag7');
        const drag8 = $('#drag8');
        const drag9 = $('#drag9');
        const drag10 = $('#drag10');
        const drag11 = $('#drag11');
        const drag12 = $('#drag12');

        const drop1 = $('#drop1');
        const drop2 = $('#drop2');
        const drop3 = $('#drop3');
        const drop4 = $('#drop4');
        const drop5 = $('#drop5');
        const drop6 = $('#drop6');
        const drop7 = $('#drop7');
        const drop8 = $('#drop8');
        const drop9 = $('#drop9');
        const drop10 = $('#drop10');
        const drop11 = $('#drop11');
        const drop12 = $('#drop12');

        let dragSelect;
        let dropSelect;
        let colocados = 0;
        let aciertos = 0;

        drags.css('cursor', 'grab');        

        // Audios------------------------------------------------------
        const audio = [
            new Audio('../audios/SODIMAC_MICASA_26_01.mp3'),
            new Audio('../audios/SODIMAC_MICASA_26_02.mp3')
        ]

        // Al cargarse la página
        $(window).on("load", function(){
            redimensionarElementos();
            aplicacion.cargando(iniciarContenido);
        });

        function iniciarContenido(){
            aplicacion.reproducirAudio(audio[0], completarVestimenta, 1);
            animacionEntrada(texto, 'default', 1, 1);
            animacionEntrada(fondo, 'default', 1, 1);
            animacionEntrada(drops, 'default', 1, 1);
            animacionEntrada(drag1, 'default', 1, 1);
            animacionEntrada(drag2, 'default', 1, 1.5);
            animacionEntrada(drag3, 'default', 1, 2);
            animacionEntrada(drag4, 'default', 1, 2.5);
            animacionEntrada(drag5, 'default', 1, 3);
        }

        function completarVestimenta(){

            drags.draggable({
                revert: true,
                start: function( event, ui ) {
                    dragSelect = $(this).data('lugar');
                    $(this).css('cursor', 'grabbing');
                },             
                stop: function( event, ui ) {
                    $(this).css('cursor', 'grab');
                }             
            });

            drops.droppable({
                accept: drags,
                tolerance: "intersect",
                drop: function( event, ui ) {
                    dropSelect = $(this).data('lugar');
                    soltar();
                }
            });
        }

        function soltar(){
            // Selecionar los elementos correspondiente
            const dragActivo = $(`#drag${dragSelect}`);
            const dropActivo = $(`#drop${dropSelect}`);

            
            //Comparar si es el lugar correspondiente
            if(dragSelect == dropSelect){
                
                //Sacar el top y el left del drop 
                const dropTop = dropActivo.css('top');
                const dropLeft = dropActivo.css('left');

                //Posicionar el drag en el drop
                dragActivo.css({
                    'top': dropTop,
                    'left': dropLeft
                });

                //Deshabilitar el regreso
                dragActivo.draggable({
                    revert: false,
                });

                //Deshabilitar drag
                dragActivo.draggable('disable');
                dragActivo.css('cursor', 'default');

                colocados++;

                if(colocados == 5){
                
                    setTimeout(()=>{
                        salidaParte1();
                        entradaParte2();
                    }, 2000);
                }

                if(colocados == 12){
                    entradaRetro();
                }
            }
        }

        function salidaParte1() {  

            animacionSalida(fondo, 'default', 1);
            animacionSalida(drop1, 'default', 1);
            animacionSalida(drop2, 'default', 1);
            animacionSalida(drop3, 'default', 1);
            animacionSalida(drop4, 'default', 1);
            animacionSalida(drop5, 'default', 1);
            animacionSalida(drag1, 'default', 1);
            animacionSalida(drag2, 'default', 1);
            animacionSalida(drag3, 'default', 1);
            animacionSalida(drag4, 'default', 1);
            animacionSalida(drag5, 'default', 1);
            }

            function entradaParte2(){
            animacionEntrada(fondo2, 'default', 1, 1);
            animacionEntrada(drop6, 'default', 1, 1);
            animacionEntrada(drop7, 'default', 1, 1);
            animacionEntrada(drop8, 'default', 1, 1);
            animacionEntrada(drop9, 'default', 1, 1);
            animacionEntrada(drop10, 'default', 1, 1);
            animacionEntrada(drop11, 'default', 1, 1);
            animacionEntrada(drop12, 'default', 1, 1);
            animacionEntrada(drag6, 'default', 1, 1);
            animacionEntrada(drag7, 'default', 1, 1.5);
            animacionEntrada(drag8, 'default', 1, 2);
            animacionEntrada(drag9, 'default', 1, 2.5);
            animacionEntrada(drag10, 'default', 1, 3);
            animacionEntrada(drag11, 'default', 1, 3.5);
            animacionEntrada(drag12, 'default', 1, 4);
        }

        function entradaRetro(){
            aplicacion.reproducirAudio(audio[1], final, 1);
            animacionEntrada(retro, 'default', 1, 1);
        }

        function final(){
            aplicacion.terminaPantalla();
        }

    </script>
</body>
</html>